(function(_0x24920f,_0xfeb450){const _0xfd4be3=a0_0x2267,_0x5082f6=_0x24920f();while(!![]){try{const _0x371c6d=parseInt(_0xfd4be3(0xd1))/0x1*(parseInt(_0xfd4be3(0xde))/0x2)+parseInt(_0xfd4be3(0xea))/0x3+parseInt(_0xfd4be3(0xc1))/0x4+parseInt(_0xfd4be3(0xd4))/0x5+-parseInt(_0xfd4be3(0xcd))/0x6*(parseInt(_0xfd4be3(0xc0))/0x7)+-parseInt(_0xfd4be3(0xe9))/0x8*(parseInt(_0xfd4be3(0xcb))/0x9)+-parseInt(_0xfd4be3(0xc2))/0xa;if(_0x371c6d===_0xfeb450)break;else _0x5082f6['push'](_0x5082f6['shift']());}catch(_0x37cc27){_0x5082f6['push'](_0x5082f6['shift']());}}}(a0_0x5629,0x34784),function(_0x47efba,_0x243b22){const _0x595c21=a0_0x2267,_0x3328a3=a0_0x1a49,_0x223f96=_0x47efba();while(!![]){try{const _0x564f59=parseInt(_0x3328a3(0x126))/0x1*(parseInt(_0x3328a3(0x12a))/0x2)+-parseInt(_0x3328a3(0x142))/0x3+-parseInt(_0x3328a3(0x133))/0x4+parseInt(_0x3328a3(0x12d))/0x5*(-parseInt(_0x3328a3(0x143))/0x6)+parseInt(_0x3328a3(0x13d))/0x7+parseInt(_0x3328a3(0x11b))/0x8*(parseInt(_0x3328a3(0x146))/0x9)+-parseInt(_0x3328a3(0x131))/0xa*(-parseInt(_0x3328a3(0x122))/0xb);if(_0x564f59===_0x243b22)break;else _0x223f96[_0x595c21(0xd8)](_0x223f96[_0x595c21(0xc8)]());}catch(_0x5bf903){_0x223f96[_0x595c21(0xd8)](_0x223f96[_0x595c21(0xc8)]());}}}(a0_0x5212,0x52183));import{SignJWT,jwtVerify}from'jose';import a0_0x3f37bc from'tweetnacl';import{renderLoginPage}from'../pages/login';function a0_0x1a49(_0x2fb4c5,_0x4f8880){const _0x13c0c4=a0_0x5212();return a0_0x1a49=function(_0x24fcb0,_0x42e9ed){_0x24fcb0=_0x24fcb0-0x11b;let _0x55b9e8=_0x13c0c4[_0x24fcb0];return _0x55b9e8;},a0_0x1a49(_0x2fb4c5,_0x4f8880);}async function generateJWTToken(_0x282b4e,_0x12318b){const _0x532b40=a0_0x2267,_0x94d1b0=a0_0x1a49,_0xcef5ea=await _0x282b4e[_0x94d1b0(0x121)](),_0x11c961=await _0x12318b[_0x94d1b0(0x139)]['get'](_0x94d1b0(0x149));if(_0xcef5ea!==_0x11c961)return new Response(_0x94d1b0(0x135),{'status':0x195});let _0x51db54=await _0x12318b[_0x94d1b0(0x139)][_0x532b40(0xca)](_0x94d1b0(0x12c));!_0x51db54&&(_0x51db54=generateSecretKey(),await _0x12318b[_0x94d1b0(0x139)][_0x94d1b0(0x145)](_0x94d1b0(0x12c),_0x51db54));const _0x5e91b6=new TextEncoder()[_0x94d1b0(0x141)](_0x51db54),_0x41e460=await new SignJWT({'userID':globalThis['userID']})[_0x94d1b0(0x144)]({'alg':_0x94d1b0(0x13f)})[_0x94d1b0(0x137)]()[_0x94d1b0(0x130)](_0x94d1b0(0x124))[_0x94d1b0(0x129)](_0x5e91b6);return new Response(_0x532b40(0xe0),{'status':0xc8,'headers':{'Set-Cookie':_0x94d1b0(0x140)+_0x41e460+_0x94d1b0(0x127)+0x7*0x18*0x3c*0x3c+_0x94d1b0(0x13e),'Content-Type':_0x94d1b0(0x12b)}});}function generateSecretKey(){const _0x5a099d=a0_0x1a49,_0x430622=a0_0x3f37bc[_0x5a099d(0x13c)](0x20);return Array[_0x5a099d(0x138)](_0x430622,_0x371761=>_0x371761[_0x5a099d(0x11f)](0x10)[_0x5a099d(0x12f)](0x2,'0'))[_0x5a099d(0x125)]('');}export async function Authenticate(_0x2e90c7,_0x7ee814){const _0x345674=a0_0x2267,_0x2cc266=a0_0x1a49;try{const _0x546902=await _0x7ee814[_0x2cc266(0x139)][_0x2cc266(0x11e)](_0x2cc266(0x12c)),_0x3c2306=new TextEncoder()[_0x2cc266(0x141)](_0x546902),_0x37079d=_0x2e90c7[_0x2cc266(0x120)][_0x2cc266(0x11e)](_0x2cc266(0x147))?.[_0x2cc266(0x11d)](/(^|;\s*)jwtToken=([^;]*)/),_0x26d95f=_0x37079d?_0x37079d[0x2]:null;if(!_0x26d95f)return console[_0x2cc266(0x134)]('Unauthorized:\x20Token\x20not\x20available!'),![];const {payload:_0x3b63bc}=await jwtVerify(_0x26d95f,_0x3c2306);return console[_0x2cc266(0x134)](_0x2cc266(0x12e)+_0x3b63bc[_0x345674(0xc5)]),!![];}catch(_0x30a311){return console[_0x2cc266(0x134)](_0x30a311),![];}}function a0_0x5629(){const _0x573047=['984834xNgIai','userID','jwtToken=','setProtectedHeader','shift','Unauthorized!','get','3582918sWAtpw','toString','20406MuSpPi','redirect',';\x20Path=/;\x20SameSite=Strict','POST','3IpVorg','bpb','urlOrigin','993245OuYvMG','Cookie','jwtToken=;\x20Path=/;\x20Secure;\x20SameSite=None;\x20Expires=Thu,\x2001\x20Jan\x201970\x2000:00:00\x20GMT','jwtToken=;\x20Secure;\x20SameSite=None;\x20Expires=Thu,\x2001\x20Jan\x201970\x2000:00:00\x20GMT','push','encode','method','log','from','text/plain','241126UJnapC','pwd','Success','match',';\x20HttpOnly;\x20Secure;\x20Max-Age=','padStart','headers','HS256','3615983ITNEhb','36yxQQKj','668438mELzjq','8VfkNwP','790107lHoWyw','1896033NRJQqo','randomBytes','756lEilns','762128jlNIhG','339130NuEuAR','setIssuedAt'];a0_0x5629=function(){return _0x573047;};return a0_0x5629();}export function logout(){const _0x1bdf46=a0_0x2267,_0x41eaaf=a0_0x1a49;return new Response(_0x41eaaf(0x13a),{'status':0xc8,'headers':{'Set-Cookie':_0x41eaaf(0x136),'Content-Type':_0x1bdf46(0xdd)}});}export async function resetPassword(_0x2ba7ee,_0x1e120c){const _0xefa485=a0_0x2267,_0x2ca6a8=a0_0x1a49;let _0x5c7c3a=await Authenticate(_0x2ba7ee,_0x1e120c);const _0x3056f0=await _0x1e120c[_0x2ca6a8(0x139)][_0x2ca6a8(0x11e)](_0xefa485(0xdf));if(_0x3056f0&&!_0x5c7c3a)return new Response(_0xefa485(0xc9),{'status':0x191});const _0x24500b=await _0x2ba7ee[_0x2ca6a8(0x121)]();if(_0x24500b===_0x3056f0)return new Response(_0x2ca6a8(0x123),{'status':0x190});return await _0x1e120c['bpb'][_0x2ca6a8(0x145)](_0x2ca6a8(0x149),_0x24500b),new Response(_0x2ca6a8(0x13a),{'status':0xc8,'headers':{'Set-Cookie':_0x2ca6a8(0x11c),'Content-Type':_0x2ca6a8(0x12b)}});}function a0_0x2267(_0x3fce0c,_0x328d37){const _0x562915=a0_0x5629();return a0_0x2267=function(_0x2267c5,_0x2b39af){_0x2267c5=_0x2267c5-0xbe;let _0x4a6977=_0x562915[_0x2267c5];return _0x4a6977;},a0_0x2267(_0x3fce0c,_0x328d37);}function a0_0x5212(){const _0x32d63e=a0_0x2267,_0x3c6d1a=[_0x32d63e(0xe3),'setExpirationTime','90ulJatC',_0x32d63e(0xda),'997544dMhtnB',_0x32d63e(0xdb),'Method\x20Not\x20Allowed',_0x32d63e(0xd7),_0x32d63e(0xc3),_0x32d63e(0xdc),_0x32d63e(0xd2),_0x32d63e(0xe0),_0x32d63e(0xce),_0x32d63e(0xbf),_0x32d63e(0xe6),_0x32d63e(0xcf),_0x32d63e(0xe5),_0x32d63e(0xc6),_0x32d63e(0xd9),_0x32d63e(0xbe),_0x32d63e(0xe7),_0x32d63e(0xc7),'put',_0x32d63e(0xc4),_0x32d63e(0xd5),_0x32d63e(0xd0),'pwd','24rhNyeS',_0x32d63e(0xd6),_0x32d63e(0xe1),_0x32d63e(0xca),_0x32d63e(0xcc),_0x32d63e(0xe4),'text','361251GXcttb','Please\x20enter\x20a\x20new\x20Password!','24h','join','2QEQDEz',_0x32d63e(0xe2),'/panel','sign',_0x32d63e(0xe8),_0x32d63e(0xdd),'secretKey','492665tymMdC','Successfully\x20authenticated,\x20User\x20ID:\x20'];return a0_0x5212=function(){return _0x3c6d1a;},a0_0x5212();}export async function login(_0x128380,_0x17c516){const _0x180b34=a0_0x2267,_0x17d969=a0_0x1a49,_0x481feb=await Authenticate(_0x128380,_0x17c516);if(_0x481feb)return Response[_0x17d969(0x13b)](globalThis[_0x180b34(0xd3)]+_0x17d969(0x128),0x12e);if(_0x128380[_0x17d969(0x132)]===_0x17d969(0x148))return await generateJWTToken(_0x128380,_0x17c516);return await renderLoginPage();}